library(tidyverse)
library(ggplot2)
library(modelr)
library(rsample)
library(mosaic)
library(caret)
library(purrr)
data(SaratogaHouses)
saratoga_split = initial_split(SaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
lm_medium = lm(price ~ . - pctCollege - sewer - waterfront - landValue - newConstruction, data=saratoga_train)
rmse(lm_medium, saratoga_test)
lm_improved = lm(price ~ . - bathrooms - pctCollege - fireplaces + newConstruction*age + rooms*bedrooms + fireplaces*bedrooms + lotSize*landValue, data = saratoga_test)
rmse(lm_improved, saratoga_test)
xtrain = model.matrix(~ . - 1, data=saratoga_train) %>%
data.frame(xtrain)
library(tidyverse)
library(ggplot2)
library(modelr)
library(rsample)
library(mosaic)
library(caret)
library(purrr)
data(SaratogaHouses)
saratoga_split = initial_split(SaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
lm_medium = lm(price ~ . - pctCollege - sewer - waterfront - landValue - newConstruction, data=saratoga_train)
rmse(lm_medium, saratoga_test)
lm_improved = lm(price ~ . - bathrooms - pctCollege - fireplaces + newConstruction*age + rooms*bedrooms + fireplaces*bedrooms + lotSize*landValue, data = saratoga_test)
rmse(lm_improved, saratoga_test)
saratoga_train_matrix = model.matrix(~ . - 1, data=saratoga_train)
saratoga_train_matrix = data.frame(saratoga_train_matrix)
saratoga_test_matrix = model.matrix(~ . - 1, data=saratoga_test)
saratoga_test_matrix = data.frame(saratoga_test_matrix)
ytrain = saratoga_train$price
ytest = saratoga_test$price
scale_train = apply(saratoga_train_matrix, 2, sd)
saratoga_tilde_train_matrix = scale(saratoga_train_matrix, scale = scale_train)
saratoga_tilde_train_matrix = data.frame(saratoga_tilde_train_matrix)
saratoga_tilde_test_matrix = scale(saratoga_test_matrix, scale = scale_train)
saratoga_tilde_test_matrix = data.frame(saratoga_tilde_test_matrix)
knn_saratoga_15 = knnreg(price ~ . - pctCollege - bathrooms, data=saratoga_tilde_train_matrix, k=15)
modelr::rmse(knn_saratoga, saratoga_tilde_test_matrix)
modelr::rmse(knn_saratoga_15, saratoga_tilde_test_matrix)
library(tidyverse)
library(ggplot2)
library(modelr)
library(rsample)
library(mosaic)
library(caret)
library(purrr)
data(SaratogaHouses)
saratoga_split = initial_split(SaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
lm_medium = lm(price ~ . - pctCollege - sewer - waterfront - landValue - newConstruction, data=saratoga_train)
rmse(lm_medium, saratoga_test)
lm_improved = lm(price ~ . - bathrooms - pctCollege - fireplaces + newConstruction*age + rooms*bedrooms + fireplaces*bedrooms + lotSize*landValue, data = saratoga_test)
rmse(lm_improved, saratoga_test)
saratoga_train_matrix = model.matrix(~ . - 1, data=saratoga_train)
saratoga_train_matrix = data.frame(saratoga_train_matrix)
saratoga_test_matrix = model.matrix(~ . - 1, data=saratoga_test)
saratoga_test_matrix = data.frame(saratoga_test_matrix)
ytrain = saratoga_train$price
ytest = saratoga_test$price
scale_train = apply(saratoga_train_matrix, 2, sd)
saratoga_tilde_train_matrix = scale(saratoga_train_matrix, scale = scale_train)
saratoga_tilde_train_matrix = data.frame(saratoga_tilde_train_matrix)
saratoga_tilde_test_matrix = scale(saratoga_test_matrix, scale = scale_train)
saratoga_tilde_test_matrix = data.frame(saratoga_tilde_test_matrix)
knn_saratoga_15 = knnreg(price ~ . - pctCollege - bathrooms, data=saratoga_tilde_train_matrix, k=15)
modelr::rmse(knn_saratoga_15, saratoga_tilde_test_matrix)
set.seed(30)
knn_vector = c(2:50)
knn_saratoga_train = list()
knn_saratoga_test = list()
knn_rmse_vector = c()
for (i in 2:length(knn_vector)){
knn_saratoga_train[[i]] = knnreg(price ~ . - pctCollege - bathrooms, data=saratoga_tilde_train_matrix, k = knn_vector[i])
knn_saratoga_test = saratoga_tilde_test_matrix %>%
mutate(PricePredict = predict(knn_saratoga_train[[i]], saratoga_tilde_test_matrix))
knn_rmse_vector = modelr::rmse(knn_saratoga_train, saratoga_tilde_test_matrix)
}
library(tidyverse)
library(ggplot2)
library(modelr)
library(rsample)
library(mosaic)
library(caret)
library(purrr)
data(SaratogaHouses)
saratoga_split = initial_split(SaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
lm_medium = lm(price ~ . - pctCollege - sewer - waterfront - landValue - newConstruction, data=saratoga_train)
rmse(lm_medium, saratoga_test)
lm_improved = lm(price ~ . - bathrooms - pctCollege - fireplaces + newConstruction*age + rooms*bedrooms + fireplaces*bedrooms + lotSize*landValue, data = saratoga_test)
rmse(lm_improved, saratoga_test)
saratoga_train_matrix = model.matrix(~ . - 1, data=saratoga_train)
saratoga_train_matrix = data.frame(saratoga_train_matrix)
saratoga_test_matrix = model.matrix(~ . - 1, data=saratoga_test)
saratoga_test_matrix = data.frame(saratoga_test_matrix)
ytrain = saratoga_train$price
ytest = saratoga_test$price
scale_train = apply(saratoga_train_matrix, 2, sd)
saratoga_tilde_train_matrix = scale(saratoga_train_matrix, scale = scale_train)
saratoga_tilde_train_matrix = data.frame(saratoga_tilde_train_matrix)
saratoga_tilde_test_matrix = scale(saratoga_test_matrix, scale = scale_train)
saratoga_tilde_test_matrix = data.frame(saratoga_tilde_test_matrix)
knn_saratoga_15 = knnreg(price ~ . - pctCollege - bathrooms, data=saratoga_tilde_train_matrix, k=15)
modelr::rmse(knn_saratoga_15, saratoga_tilde_test_matrix)
set.seed(30)
knn_vector = c(2:346)
knn_saratoga_train = list()
knn_saratoga_test = list()
knn_rmse_vector = c()
for (i in 2:length(knn_vector)){
knn_saratoga_train[[i]] = knnreg(price ~ . - pctCollege - bathrooms, data=saratoga_tilde_train_matrix, k = knn_vector[i])
knn_saratoga_test = saratoga_tilde_test_matrix %>%
mutate(PricePredict = predict(knn_saratoga_train[[i]], saratoga_tilde_test_matrix))
knn_rmse_vector[i] = modelr::rmse(knn_saratoga_train[[i]], saratoga_tilde_test_matrix)
}
plot(knn_vector, knn_rmse_vector)
knn_rmse_vector_df = data_frame(knn_vector, knn_rmse_vector)
knn_saratoga_7 = knnreg(price ~ . - pctCollege - bathrooms, data=saratoga_tilde_train_matrix, k=7)
modelr::rmse(knn_saratoga_7, saratoga_tilde_test_matrix)
